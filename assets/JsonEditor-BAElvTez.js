import{r as O,j as t}from"./index-CVcNbIs1.js";class R extends Error{constructor(e,s){super(`${e} at position ${s}`),this.position=s}}const oe=32,pe=10,le=9,ce=13,he=160,ge=8192,me=8202,be=8239,je=8287,we=12288;function Ne(n){return/^[0-9A-Fa-f]$/.test(n)}function k(n){return n>="0"&&n<="9"}function Se(n){return n>=" "}function Q(n){return`,:[]/{}()
+`.includes(n)}function Y(n){return n>="a"&&n<="z"||n>="A"&&n<="Z"||n==="_"||n==="$"}function x(n){return n>="a"&&n<="z"||n>="A"&&n<="Z"||n==="_"||n==="$"||n>="0"&&n<="9"}const ee=/^(http|https|ftp|mailto|file|data|irc):\/\/$/,ne=/^[A-Za-z0-9-._~:/?#@!$&'()*+;=]$/;function se(n){return`,[]/{}
+`.includes(n)}function re(n){return B(n)||ye.test(n)}const ye=/^[[{\w-]$/;function Ce(n){return n===`
`||n==="\r"||n==="	"||n==="\b"||n==="\f"}function T(n,e){const s=n.charCodeAt(e);return s===oe||s===pe||s===le||s===ce}function Oe(n,e){const s=n.charCodeAt(e);return s===oe||s===le||s===ce}function Ee(n,e){const s=n.charCodeAt(e);return s===he||s>=ge&&s<=me||s===be||s===je||s===we}function B(n){return ae(n)||q(n)}function ae(n){return n==='"'||n==="“"||n==="”"}function ie(n){return n==='"'}function q(n){return n==="'"||n==="‘"||n==="’"||n==="`"||n==="´"}function te(n){return n==="'"}function I(n,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const V=n.lastIndexOf(e);return V!==-1?n.substring(0,V)+(s?"":n.substring(V+1)):n}function N(n,e){let s=n.length;if(!T(n,s-1))return n+e;for(;T(n,s-1);)s--;return n.substring(0,s)+e+n.substring(s)}function $e(n,e,s){return n.substring(0,e)+n.substring(e+s)}function Je(n){return/[,\n][ \t\r]*$/.test(n)}const ve={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},Ae={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"};function ke(n){let e=0,s="";U(["```","[```","{```"]),E()||ue(),U(["```","```]","```}"]);const b=j(",");for(b&&a(),re(n[e])&&Je(s)?(b||(s=N(s,",")),_()):b&&(s=I(s,","));n[e]==="}"||n[e]==="]";)e++,a();if(e>=n.length)return s;$();function E(){a();const i=K()||H()||C()||Z()||r()||c(!1)||d();return a(),i}function a(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const l=e;let u=g(i);do u=L(),u&&(u=g(i));while(u);return e>l}function g(i){const l=i?T:Oe;let u="";for(;;)if(l(n,e))u+=n[e],e++;else if(Ee(n,e))u+=" ",e++;else break;return u.length>0?(s+=u,!0):!1}function L(){if(n[e]==="/"&&n[e+1]==="*"){for(;e<n.length&&!Te(n,e);)e++;return e+=2,!0}if(n[e]==="/"&&n[e+1]==="/"){for(;e<n.length&&n[e]!==`
`;)e++;return!0}return!1}function U(i){if(v(i)){if(Y(n[e]))for(;e<n.length&&x(n[e]);)e++;return a(),!0}return!1}function v(i){g(!0);for(const l of i){const u=e+l.length;if(n.slice(e,u)===l)return e=u,!0}return!1}function j(i){return n[e]===i?(s+=n[e],e++,!0):!1}function y(i){return n[e]===i?(e++,!0):!1}function M(){return y("\\")}function W(){return a(),n[e]==="."&&n[e+1]==="."&&n[e+2]==="."?(e+=3,a(),y(","),!0):!1}function K(){if(n[e]==="{"){s+="{",e++,a(),y(",")&&a();let i=!0;for(;e<n.length&&n[e]!=="}";){let l;if(i?(l=!0,i=!1):(l=j(","),l||(s=N(s,",")),a()),W(),!(C()||c(!0))){n[e]==="}"||n[e]==="{"||n[e]==="]"||n[e]==="["||n[e]===void 0?s=I(s,","):fe();break}a();const P=j(":"),A=e>=n.length;P||(re(n[e])||A?s=N(s,":"):G()),E()||(P||A?s+="null":G())}return n[e]==="}"?(s+="}",e++):s=N(s,"}"),!0}return!1}function H(){if(n[e]==="["){s+="[",e++,a(),y(",")&&a();let i=!0;for(;e<n.length&&n[e]!=="]";)if(i?i=!1:j(",")||(s=N(s,",")),W(),!E()){s=I(s,",");break}return n[e]==="]"?(s+="]",e++):s=N(s,"]"),!0}return!1}function _(){let i=!0,l=!0;for(;l;)i?i=!1:j(",")||(s=N(s,",")),l=E();l||(s=I(s,",")),s=`[
${s}
]`}function C(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,u=n[e]==="\\";if(u&&(e++,u=!0),B(n[e])){const P=ie(n[e])?ie:te(n[e])?te:q(n[e])?q:ae,A=e,D=s.length;let p='"';for(e++;;){if(e>=n.length){const h=f(e-1);return!i&&Q(n.charAt(h))?(e=A,s=s.substring(0,D),C(!0)):(p=N(p,'"'),s+=p,!0)}if(e===l)return p=N(p,'"'),s+=p,!0;if(P(n[e])){const h=e,z=p.length;if(p+='"',e++,s+=p,a(!1),i||e>=n.length||Q(n[e])||B(n[e])||k(n[e]))return F(),!0;const J=f(h-1),X=n.charAt(J);if(X===",")return e=A,s=s.substring(0,D),C(!1,J);if(Q(X))return e=A,s=s.substring(0,D),C(!0);s=s.substring(0,D),e=h+1,p=`${p.substring(0,z)}\\${p.substring(z)}`}else if(i&&se(n[e])){if(n[e-1]===":"&&ee.test(n.substring(A+1,e+2)))for(;e<n.length&&ne.test(n[e]);)p+=n[e],e++;return p=N(p,'"'),s+=p,F(),!0}else if(n[e]==="\\"){const h=n.charAt(e+1);if(Ae[h]!==void 0)p+=n.slice(e,e+2),e+=2;else if(h==="u"){let J=2;for(;J<6&&Ne(n[e+J]);)J++;J===6?(p+=n.slice(e,e+6),e+=6):e+J>=n.length?e=n.length:de()}else p+=h,e+=2}else{const h=n.charAt(e);h==='"'&&n[e-1]!=="\\"?(p+=`\\${h}`,e++):Ce(h)?(p+=ve[h],e++):(Se(h)||S(h),p+=h,e++)}u&&M()}}return!1}function F(){let i=!1;for(a();n[e]==="+";){i=!0,e++,a(),s=I(s,'"',!0);const l=s.length;C()?s=$e(s,l,1):s=N(s,'"')}return i}function Z(){const i=e;if(n[e]==="-"){if(e++,m())return w(i),!0;if(!k(n[e]))return e=i,!1}for(;k(n[e]);)e++;if(n[e]==="."){if(e++,m())return w(i),!0;if(!k(n[e]))return e=i,!1;for(;k(n[e]);)e++}if(n[e]==="e"||n[e]==="E"){if(e++,(n[e]==="-"||n[e]==="+")&&e++,m())return w(i),!0;if(!k(n[e]))return e=i,!1;for(;k(n[e]);)e++}if(!m())return e=i,!1;if(e>i){const l=n.slice(i,e),u=/^0\d/.test(l);return s+=u?`"${l}"`:l,!0}return!1}function r(){return o("true","true")||o("false","false")||o("null","null")||o("True","true")||o("False","false")||o("None","null")}function o(i,l){return n.slice(e,e+i.length)===i?(s+=l,e+=i.length,!0):!1}function c(i){const l=e;if(Y(n[e])){for(;e<n.length&&x(n[e]);)e++;let u=e;for(;T(n,u);)u++;if(n[u]==="(")return e=u+1,E(),n[e]===")"&&(e++,n[e]===";"&&e++),!0}for(;e<n.length&&!se(n[e])&&!B(n[e])&&(!i||n[e]!==":");)e++;if(n[e-1]===":"&&ee.test(n.substring(l,e+2)))for(;e<n.length&&ne.test(n[e]);)e++;if(e>l){for(;T(n,e-1)&&e>0;)e--;const u=n.slice(l,e);return s+=u==="undefined"?"null":JSON.stringify(u),n[e]==='"'&&e++,!0}}function d(){if(n[e]==="/"){const i=e;for(e++;e<n.length&&(n[e]!=="/"||n[e-1]==="\\");)e++;return e++,s+=`"${n.substring(i,e)}"`,!0}}function f(i){let l=i;for(;l>0&&T(n,l);)l--;return l}function m(){return e>=n.length||Q(n[e])||T(n,e)}function w(i){s+=`${n.slice(i,e)}0`}function S(i){throw new R(`Invalid character ${JSON.stringify(i)}`,e)}function $(){throw new R(`Unexpected character ${JSON.stringify(n[e])}`,e)}function ue(){throw new R("Unexpected end of json string",n.length)}function fe(){throw new R("Object key expected",e)}function G(){throw new R("Colon expected",e)}function de(){const i=n.slice(e,e+6);throw new R(`Invalid unicode character "${i}"`,e)}}function Te(n,e){return n[e]==="*"&&n[e+1]==="/"}const Re=()=>{const[n,e]=O.useState(`{
    "name": "John Doe",
    "age": 30,
    "isActive": true,
    "address": {
      "street": "123 Main St",
      "city": "Anytown"
    },
    "hobbies": ["reading", "hiking", "coding"],
    "contacts": [
      {
        "type": "email",
        "value": "john@example.com"
      },
      {
        "type": "phone",
        "value": "555-1234"
      }
    ]
  }`),[s,V]=O.useState(null),[b,E]=O.useState("text"),[a,g]=O.useState({message:"",line:null,position:null}),[L,U]=O.useState(new Set),v=O.useRef(null),j=O.useRef(null);O.useEffect(()=>{if(b==="text"&&j.current){const r=n.split(`
`);j.current.innerHTML=r.map((o,c)=>`<div>${c+1}</div>`).join("")}},[n,b]),O.useEffect(()=>{try{const r=JSON.parse(n);V(r),g({message:"",line:null,position:null})}catch(r){const{line:o,position:c}=y(r.message,n);g({message:r.message,line:o,position:c}),b!=="text"&&E("text")}},[n,b]);const y=(r,o)=>{const c=r.match(/at position (\d+)/);if(!c)return{line:null,position:null};const d=parseInt(c[1]),f=o.split(`
`);let m=0,w=0;for(let S=0;S<f.length;S++){w=S+1;const $=f[S].length+1;if(m+$>d)return{line:w,position:d-m};m+=$}return{line:null,position:null}},M=()=>{if(!a.line||!v.current)return;const r=v.current,o=r.value.split(`
`);let c=0;for(let f=0;f<a.line-1;f++)c+=o[f].length+1;c+=a.position,r.focus(),r.setSelectionRange(c,c);const d=r.clientHeight/r.rows;r.scrollTop=(a.line-1)*d},W=()=>{try{JSON.parse(n),g({message:"No fixes needed - JSON is already valid",line:null,position:null})}catch{try{const o=ke(n);JSON.parse(o),e(o),g({message:"JSON successfully repaired",line:null,position:null}),setTimeout(()=>{try{const c=JSON.parse(o);e(JSON.stringify(c,null,2))}catch(c){console.warn("Formatting repaired JSON failed:",c)}},100)}catch(o){const{line:c,position:d}=y(o.message,n);g({message:`Repair failed: ${o.message}`,line:c,position:d})}}},K=()=>{try{const r=JSON.parse(n);e(JSON.stringify(r,null,2)),g({message:"JSON formatted successfully",line:null,position:null}),setTimeout(()=>g({message:"",line:null,position:null}),2e3)}catch(r){const{line:o,position:c}=y(r.message,n);g({message:r.message,line:o,position:c})}},H=()=>{try{const r=JSON.parse(n);e(JSON.stringify(r)),g({message:"JSON compacted successfully",line:null,position:null}),setTimeout(()=>g({message:"",line:null,position:null}),2e3)}catch(r){const{line:o,position:c}=y(r.message,n);g({message:r.message,line:o,position:c})}},_=r=>{const o=new Set(L);o.has(r)?o.delete(r):o.add(r),U(o)},C=(r,o="")=>{if(typeof r=="object"&&r!==null){const c=Array.isArray(r);return Object.entries(r).map(([d,f],m)=>{const w=`${o}/${d}`,S=L.has(w),$=typeof f=="object"&&f!==null;return t.jsxs("div",{className:"tree-node",children:[t.jsxs("div",{className:"tree-item",children:[$&&t.jsx("button",{className:"tree-toggle",onClick:()=>_(w),"aria-label":S?"Collapse":"Expand",children:S?"▼":"▶"}),t.jsxs("span",{className:"tree-key",children:[c?`[${d}]`:d,":"]}),$?t.jsx("span",{className:"tree-summary",children:Array.isArray(f)?`[${f.length} items]`:`{${Object.keys(f).length} properties}`}):t.jsx("span",{className:"tree-value",children:typeof f=="string"?`"${f}"`:String(f)})]}),$&&S&&t.jsx("div",{className:"tree-children",children:C(f,w)})]},w)})}return null},F=()=>{j.current&&v.current&&(j.current.scrollTop=v.current.scrollTop)},Z=r=>{if(Array.isArray(r)){if(r.length>0&&typeof r[0]=="object"&&r[0]!==null){const o=new Set;r.forEach(d=>Object.keys(d).forEach(f=>o.add(f)));const c=Array.from(o);return t.jsxs("table",{className:"json-table",children:[t.jsx("thead",{children:t.jsx("tr",{children:c.map(d=>t.jsx("th",{children:d},d))})}),t.jsx("tbody",{children:r.map((d,f)=>t.jsx("tr",{children:c.map(m=>t.jsx("td",{children:d[m]===void 0?"":typeof d[m]=="object"?JSON.stringify(d[m]):String(d[m])},`${f}-${m}`))},f))})]})}return t.jsx("div",{children:JSON.stringify(r)})}else if(typeof r=="object"&&r!==null)return t.jsx("table",{className:"json-table",children:t.jsx("tbody",{children:Object.entries(r).map(([o,c])=>t.jsxs("tr",{children:[t.jsx("td",{children:o}),t.jsx("td",{children:typeof c=="object"?JSON.stringify(c):String(c)})]},o))})});return t.jsx("div",{children:JSON.stringify(r)})};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"json-editor-container container",children:[t.jsx("h1",{className:"content-title",children:"JSON Editor"}),t.jsxs("div",{className:"toolbar",children:[t.jsx("button",{onClick:K,children:"Format"}),t.jsx("button",{onClick:H,children:"Compact"}),t.jsx("button",{onClick:W,children:"Auto Fix Error"}),a.message&&a.line&&t.jsx("button",{onClick:M,children:"Show Error"})]}),t.jsx("div",{className:"view-tabs",children:["text","tree","table"].map(r=>t.jsx("div",{className:`view-tab ${b===r?"active":""}`,onClick:()=>E(r),children:r.charAt(0).toUpperCase()+r.slice(1)},r))}),t.jsxs("div",{className:"editor-container",children:[b==="text"&&t.jsxs("div",{className:"text-editor-wrapper",children:[t.jsx("div",{className:"line-numbers",ref:j}),t.jsx("textarea",{ref:v,className:`json-text ${a.line?"has-error":""}`,value:n,onChange:r=>e(r.target.value),onScroll:F,"data-error-line":a.line||void 0})]}),b==="tree"&&s&&t.jsx("div",{className:"json-tree",children:C(s)}),b==="table"&&s&&t.jsx("div",{className:"json-table-container",children:Z(s)})]}),a.message&&t.jsxs("div",{className:`error-message ${a.line?"is-error":"is-success"}`,children:[a.message,a.line&&` (Line ${a.line}, Position ${a.position})`]})]})})};export{Re as default};
