import{r as s,j as e}from"./index-CVcNbIs1.js";import{a as b}from"./index-ngrFHoWO.js";import{u as z}from"./index-VHgGGu6K.js";import{T as C}from"./ThemeableSelect-BAkb02Mq.js";import{z as p}from"./index-2roNfZMn.js";import"./index-C8zOzmke.js";import"./index-Chjiymov.js";import"./tslib.es6-DL2BruWv.js";import"./slicedToArray-DOD8vD1W.js";import"./defineProperty-DWm6lKFB.js";import"./toConsumableArray-CFt2I6r5.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./extends-CF3RwP-h.js";import"./memoize-one.esm-BHZvq9gn.js";import"./globalStore-ByoUXurI.js";function O(){const[o,n]=s.useState(null),[r,v]=s.useState("docx"),[c,h]=s.useState(!1),i=[{label:"Doc",value:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"},{label:"PDF",value:"pdf",mime:"application/pdf"},{label:"Excel",value:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},{label:"PPT",value:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"},{label:"Txt",value:"txt",mime:"text/plain"},{label:"Html",value:"html",mime:"text/html"},{label:"RTF",value:"rtf",mime:"application/rtf"},{label:"ODS",value:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"},{label:"ODT",value:"odt",mime:"application/vnd.oasis.opendocument.text"},{label:"ODP",value:"odp",mime:"application/vnd.oasis.opendocument.presentation"}],x=i.reduce((a,t)=>(a[t.mime]=[`.${t.value}`],a),{}),u=s.useCallback(a=>{a&&a.length>0&&n(a[0])},[]),{getRootProps:w,getInputProps:f,isDragActive:g}=z({onDrop:u,accept:x,multiple:!1}),j=async a=>{if(a.preventDefault(),!o){p.error("Please select a file to upload.",{position:"top-right"});return}const t=new FormData;t.append("file",o),t.append("format",r),h(!0);try{const m=await b.post("https://api.prosysvps.com/api/convert",t,{responseType:"blob",headers:{"Content-Type":"multipart/form-data"}}),d=window.URL.createObjectURL(new Blob([m.data])),l=document.createElement("a");l.href=d,l.setAttribute("download",`converted_${Date.now()}.${r}`),document.body.appendChild(l),l.click(),l.parentNode.removeChild(l),window.URL.revokeObjectURL(d),n(null)}catch{p.error("An error occurred.",{position:"top-right"})}finally{h(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("section",{className:"container",children:[e.jsx("h1",{className:"content-title",children:"Document Converter"}),e.jsxs("div",{className:"drop-zone-wrapper",children:[e.jsxs("div",{...w(),className:"dropzone",children:[e.jsx("input",{...f()}),e.jsx("div",{className:"drop-icon",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",className:"bi bi-box-arrow-down",viewBox:"0 0 16 16",children:[e.jsx("path",{fillRule:"evenodd",d:"M3.5 10a.5.5 0 0 1-.5-.5v-8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0 0 1h2A1.5 1.5 0 0 0 14 9.5v-8A1.5 1.5 0 0 0 12.5 0h-9A1.5 1.5 0 0 0 2 1.5v8A1.5 1.5 0 0 0 3.5 11h2a.5.5 0 0 0 0-1z"}),e.jsx("path",{fillRule:"evenodd",d:"M7.646 15.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 14.293V5.5a.5.5 0 0 0-1 0v8.793l-2.146-2.147a.5.5 0 0 0-.708.708z"})]})}),o?e.jsx(e.Fragment,{children:e.jsxs("p",{children:["Selected File: ",o.name]})}):g?e.jsx("p",{children:"Almost there! Drop the file here to upload..."}):e.jsx("p",{children:"Drag & Drop a file here, or click to select one"})]}),e.jsxs("div",{className:"doc-convert-to",children:[e.jsx("label",{children:"Convert To"}),e.jsx(C,{id:"doc-format",value:i.filter(a=>a.value===r),onChange:a=>v(a.value),className:"doc-convert-select",options:i,formatOptionLabel:a=>e.jsxs("div",{className:"doc-convert-option",children:[a.value=="docx"&&e.jsx(e.Fragment,{children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-file-earmark-word",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M5.485 6.879a.5.5 0 1 0-.97.242l1.5 6a.5.5 0 0 0 .967.01L8 9.402l1.018 3.73a.5.5 0 0 0 .967-.01l1.5-6a.5.5 0 0 0-.97-.242l-1.036 4.144-.997-3.655a.5.5 0 0 0-.964 0l-.997 3.655L5.485 6.88z"}),e.jsx("path",{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"})]})})||a.value=="pdf"&&e.jsx(e.Fragment,{children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-file-pdf",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1"}),e.jsx("path",{d:"M4.603 12.087a.8.8 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.7 7.7 0 0 1 1.482-.645 20 20 0 0 0 1.062-2.227 7.3 7.3 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.187-.012.395-.047.614-.084.51-.27 1.134-.52 1.794a11 11 0 0 0 .98 1.686 5.8 5.8 0 0 1 1.334.05c.364.065.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.86.86 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.7 5.7 0 0 1-.911-.95 11.6 11.6 0 0 0-1.997.406 11.3 11.3 0 0 1-1.021 1.51c-.29.35-.608.655-.926.787a.8.8 0 0 1-.58.029m1.379-1.901q-.25.115-.459.238c-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361q.016.032.026.044l.035-.012c.137-.056.355-.235.635-.572a8 8 0 0 0 .45-.606m1.64-1.33a13 13 0 0 1 1.01-.193 12 12 0 0 1-.51-.858 21 21 0 0 1-.5 1.05zm2.446.45q.226.244.435.41c.24.19.407.253.498.256a.1.1 0 0 0 .07-.015.3.3 0 0 0 .094-.125.44.44 0 0 0 .059-.2.1.1 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a4 4 0 0 0-.612-.053zM8.078 5.8a7 7 0 0 0 .2-.828q.046-.282.038-.465a.6.6 0 0 0-.032-.198.5.5 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822q.036.167.09.346z"})]})})||a.value=="xlsx"&&e.jsx(e.Fragment,{children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-file-excel",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M5.18 4.616a.5.5 0 0 1 .704.064L8 7.219l2.116-2.54a.5.5 0 1 1 .768.641L8.651 8l2.233 2.68a.5.5 0 0 1-.768.64L8 8.781l-2.116 2.54a.5.5 0 0 1-.768-.641L7.349 8 5.116 5.32a.5.5 0 0 1 .064-.704"}),e.jsx("path",{d:"M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1"})]})})||a.value=="pptx"&&e.jsx(e.Fragment,{children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-file-richtext",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M7 4.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m-.861 1.542 1.33.886 1.854-1.855a.25.25 0 0 1 .289-.047l1.888.974V7.5a.5.5 0 0 1-.5.5H5a.5.5 0 0 1-.5-.5V7s1.54-1.274 1.639-1.208M5 9a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"}),e.jsx("path",{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"})]})})||a.value=="txt"&&e.jsx(e.Fragment,{children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-file-text",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"}),e.jsx("path",{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"})]})})||a.value=="html"&&e.jsx(e.Fragment,{children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-file-earmark-code",viewBox:"0 0 16 16",children:[e.jsx("path",{d:"M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h5.5zm-3 0A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4.5z"}),e.jsx("path",{d:"M8.646 6.646a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L10.293 9 8.646 7.354a.5.5 0 0 1 0-.708m-1.292 0a.5.5 0 0 0-.708 0l-2 2a.5.5 0 0 0 0 .708l2 2a.5.5 0 0 0 .708-.708L5.707 9l1.647-1.646a.5.5 0 0 0 0-.708"})]})})||["rtf","ods","odt","odp"].includes(a.value)&&e.jsx(e.Fragment,{children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-file-spreadsheet",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v4h10V2a1 1 0 0 0-1-1zm9 6h-3v2h3zm0 3h-3v2h3zm0 3h-3v2h2a1 1 0 0 0 1-1zm-4 2v-2H6v2zm-4 0v-2H3v1a1 1 0 0 0 1 1zm-2-3h2v-2H3zm0-3h2V7H3zm3-2v2h3V7zm3 3H6v2h3z"})})}),e.jsx("span",{children:a.label})]})})]}),e.jsx("div",{className:"flex justify-content-center",children:e.jsx("button",{type:"button",className:"btn",onClick:j,disabled:c||!o,children:c?"Converting...":"Convert & Download"})})]})]})})}export{O as default};
