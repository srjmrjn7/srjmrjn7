import{r as a,j as e}from"./index-CVcNbIs1.js";import{z as P}from"./index-2roNfZMn.js";const G=()=>{const[w,f]=a.useState(!1),[S,b]=a.useState(null),[v,y]=a.useState(null),[x,z]=a.useState(null),[M,p]=a.useState(0),[l,m]=a.useState(""),[N,j]=a.useState(""),[h,H]=a.useState(null),[g,R]=a.useState(null),[O,T]=a.useState({}),k=[{id:"cloudflare-na",name:"Cloudflare (North America)",url:"https://speed.cloudflare.com/__down?bytes=10000000",size:1e7,location:"North America",region:"us"},{id:"linode-us-east",name:"Linode (Newark, US)",url:"https://speedtest.newark.linode.com/100MB-newark.bin",size:1e8,location:"Newark, NJ, USA",region:"us"},{id:"linode-us-west",name:"Linode (Fremont, US)",url:"https://speedtest.fremont.linode.com/100MB-fremont.bin",size:1e8,location:"Fremont, CA, USA",region:"us"},{id:"digitalocean-nyc",name:"DigitalOcean (New York)",url:"https://speedtest-nyc1.digitalocean.com/100mb.test",size:1e8,location:"New York, USA",region:"us"},{id:"cloudflare-eu",name:"Cloudflare (Europe)",url:"https://eu.speed.cloudflare.com/__down?bytes=10000000",size:1e7,location:"London, UK",region:"eu"},{id:"ovh-france",name:"OVH (France)",url:"https://proof.ovh.net/files/100Mb.dat",size:1e8,location:"Roubaix, France",region:"eu"},{id:"tele2-eu",name:"Tele2 (Europe)",url:"https://speedtest.tele2.net/10MB.zip",size:1e7,location:"Stockholm, Sweden",region:"eu"},{id:"hetzner-de",name:"Hetzner (Germany)",url:"https://speed.hetzner.de/100MB.bin",size:1e8,location:"Falkenstein, Germany",region:"eu"},{id:"digitalocean-sgp",name:"DigitalOcean (Singapore)",url:"https://speedtest-sgp1.digitalocean.com/100mb.test",size:1e8,location:"Singapore",region:"asia"},{id:"linode-jp",name:"Linode (Tokyo)",url:"https://speedtest.tokyo2.linode.com/100MB-tokyo.bin",size:1e8,location:"Tokyo, Japan",region:"asia"},{id:"aws-sgp",name:"AWS (Singapore)",url:"https://s3-ap-southeast-1.amazonaws.com/files.speedtest/speedtest.10MB",size:1e7,location:"Singapore",region:"asia"},{id:"alibaba-hk",name:"Alibaba Cloud (Hong Kong)",url:"https://speedtest-hk.aliyun.com/download?size=10000000",size:1e7,location:"Hong Kong",region:"asia"},{id:"digitalocean-syd",name:"DigitalOcean (Sydney)",url:"https://speedtest-syd1.digitalocean.com/100mb.test",size:1e8,location:"Sydney, Australia",region:"oceania"},{id:"linode-au",name:"Linode (Sydney)",url:"https://speedtest.syd1.linode.com/100MB-sydney.bin",size:1e8,location:"Sydney, Australia",region:"oceania"},{id:"digitalocean-brazil",name:"DigitalOcean (Brazil)",url:"https://speedtest-blr1.digitalocean.com/100mb.test",size:1e8,location:"SÃ£o Paulo, Brazil",region:"sa"},{id:"liquid-za",name:"Liquid Telecom (South Africa)",url:"https://capetown.speedtest.liquidtelecom.com/download",size:1e7,location:"Cape Town, South Africa",region:"africa"}],E=[{id:"cloudflare-up",name:"Cloudflare Upload",url:"https://speed.cloudflare.com/__up",size:2e6,location:"Global",region:"global"},{id:"tele2-up",name:"Tele2 Upload (Europe)",url:"https://speedtest.tele2.net/upload.php",size:2e6,location:"Stockholm, Sweden",region:"eu"},{id:"linode-up-us",name:"Linode Upload (US East)",url:"https://speedtest.newark.linode.com/upload",size:2e6,location:"Newark, NJ, USA",region:"us"},{id:"httpbin",name:"HTTPBin (Fallback)",url:"https://httpbin.org/post",size:1e6,location:"Global",region:"global"}];a.useEffect(()=>{const t={};[...k,...E].forEach(o=>{t[o.id]={status:"unknown",lastChecked:null}}),T(t)},[]);const i=(t,o)=>{T(n=>({...n,[t]:{status:o,lastChecked:new Date().toLocaleTimeString()}}))},F=async()=>{f(!0),b(null),y(null),z(null),p(0);try{m("ping");const t=await $();z(t),p(10),m("download");let o;if(h)try{o=await U(h),i(h.id,"online")}catch(r){throw i(h.id,"offline"),new Error(`Selected download server failed: ${r.message}`)}else o=await L();b(o),p(60),m("upload");let n;if(g)try{n=await D(g),i(g.id,"online")}catch(r){throw i(g.id,"offline"),new Error(`Selected upload server failed: ${r.message}`)}else n=await C();y(n),p(100)}catch(t){P.error(t.message||"Speed test failed. Please try again.",{position:"top-right"})}finally{f(!1),m("")}},$=async()=>{const t=performance.now();try{const o=["https://www.google.com/favicon.ico","https://cdn.jsdelivr.net/npm/react@latest/package.json","https://api.github.com"];for(const n of o)try{await fetch(n,{method:"HEAD",cache:"no-store",mode:"no-cors"});const r=performance.now();return Math.round(r-t)}catch{continue}throw new Error("Ping test failed")}catch(o){return P.error(`Ping error: ${o}`,{position:"top-right"}),"N/A"}},L=async()=>{for(const t of k){j(t.name),i(t.id,"testing");try{const o=await U(t);return i(t.id,"online"),o}catch(o){console.warn(`Download failed on ${t.name}:`,o),i(t.id,"offline");continue}}throw new Error("All download servers failed")},U=t=>new Promise((o,n)=>{const r=performance.now(),s=new XMLHttpRequest;s.open("GET",`${t.url}?nocache=${Date.now()}`,!0),s.onprogress=d=>{if(d.lengthComputable){const u=d.loaded/d.total*50+10;p(Math.floor(u))}},s.onload=()=>{if(s.status===200){const d=(performance.now()-r)/1e3,c=(t.size*8/d/1e6).toFixed(2);o(parseFloat(c))}else n(new Error(`HTTP ${s.status}`))},s.onerror=()=>n(new Error("Network error")),s.ontimeout=()=>n(new Error("Timeout")),s.timeout=15e3,s.send()}),C=async()=>{for(const t of E){j(t.name),i(t.id,"testing");try{const o=await D(t);return i(t.id,"online"),o}catch(o){console.warn(`Upload failed on ${t.name}:`,o),i(t.id,"offline");continue}}throw new Error("All upload servers failed")},D=t=>new Promise((o,n)=>{const r=performance.now(),s=new XMLHttpRequest,d=new Blob([new Uint8Array(t.size)],{type:"application/octet-stream"});s.open("POST",t.url,!0),s.upload.onprogress=c=>{if(c.lengthComputable){const A=c.loaded/c.total*40+60;p(Math.floor(A))}},s.onload=()=>{if(s.status>=200&&s.status<300){const c=(performance.now()-r)/1e3,B=(t.size*8/c/1e6).toFixed(2);o(parseFloat(B))}else n(new Error(`HTTP ${s.status}`))},s.onerror=()=>n(new Error("Network error")),s.ontimeout=()=>n(new Error("Timeout")),s.timeout=2e4;const u=new FormData;u.append("file",d,"speedtest.bin"),s.send(u)});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container",children:[e.jsx("h1",{className:"content-title",children:"Internet Speed Test"}),e.jsxs("div",{className:"speed-results",children:[e.jsxs("div",{className:"speed-card",children:[e.jsx("div",{className:"speed-label",children:"Ping"}),e.jsx("div",{className:"speed-value",children:x!==null?`${x} ms`:"--"})]}),e.jsxs("div",{className:"speed-card",children:[e.jsx("div",{className:"speed-label",children:"Download"}),e.jsx("div",{className:"speed-value",children:S!==null?`${S} Mbps`:"--"})]}),e.jsxs("div",{className:"speed-card",children:[e.jsx("div",{className:"speed-label",children:"Upload"}),e.jsx("div",{className:"speed-value",children:v!==null?`${v} Mbps`:"--"})]})]}),e.jsxs("div",{className:"progress-container",children:[e.jsxs("div",{className:"progress-labels",children:[l==="ping"&&e.jsx("span",{children:"Ping"}),l==="download"&&e.jsx("span",{children:"Download"}),l==="upload"&&e.jsx("span",{children:"Upload"})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${M}%`}})}),w&&e.jsxs("div",{className:"active-server",children:[l==="ping"&&"Measuring latency...",l==="download"&&`Downloading from: ${N}`,l==="upload"&&`Uploading to: ${N}`]})]}),e.jsx("button",{onClick:F,disabled:w,className:"test-button",children:w?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),l==="ping"&&"Testing Ping...",l==="download"&&"Testing Download...",l==="upload"&&"Testing Upload..."]}):"Start Speed Test"}),e.jsxs("div",{className:"troubleshooting",children:[e.jsx("h3",{children:"Tips for Accurate Results:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"For local servers, choose a geographically close location"}),e.jsx("li",{children:"Disable VPNs and proxy connections during testing"}),e.jsx("li",{children:"Close bandwidth-intensive applications"}),e.jsx("li",{children:"Use wired Ethernet connection when possible"})]})]})]})})};export{G as default};
