import{r as a,j as e,H as O}from"./index-CVcNbIs1.js";async function p(){return await window.crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey","deriveBits"])}async function j(t){const r=await window.crypto.subtle.exportKey("jwk",t);return JSON.stringify(r)}async function v(t){const r=await window.crypto.subtle.exportKey("jwk",t);return JSON.stringify(r)}async function K(t,r){const c=await window.crypto.subtle.importKey("jwk",JSON.parse(r),{name:"ECDH",namedCurve:"P-256"},!1,[]);return await window.crypto.subtle.deriveBits({name:"ECDH",public:c},t,256)}function m(t){return Array.from(new Uint8Array(t)).map(r=>r.toString(16).padStart(2,"0")).join("")}function J(){const[t,r]=a.useState(""),[c,w]=a.useState(""),[o,S]=a.useState(""),[n,C]=a.useState(""),[d,g]=a.useState(""),[u,k]=a.useState(""),[y,x]=a.useState(!1),P=async()=>{x(!0);try{const i=await p(),h=await j(i.publicKey),f=await v(i.privateKey);w(h),r(f);const l=await p(),b=await j(l.publicKey),E=await v(l.privateKey);C(b),S(E);const H=await K(i.privateKey,b),N=await K(l.privateKey,h),D=m(H),B=m(N);g(D),k(B)}catch(i){console.error("Error generating ECDH keys:",i),alert("Error generating keys. See console for details.")}finally{x(!1)}},s=i=>{navigator.clipboard.writeText(i)};return e.jsxs(e.Fragment,{children:[e.jsx(O,{children:e.jsx("title",{children:"ECDH Key Exchange (Elliptic Curve Diffie-Hellman) - Suraj Site"})}),e.jsxs("div",{className:"ecdh-exchange",children:[e.jsx("h2",{children:"ECDH Key Exchange (Elliptic Curve Diffie-Hellman)"}),e.jsx("div",{className:"controls",children:e.jsx("button",{onClick:P,disabled:y,children:y?"Generating Keys...":"Generate Keys"})}),(c||n)&&e.jsxs("div",{className:"ecdh-keys",children:[e.jsxs("div",{className:"party",children:[e.jsx("h3",{children:"Alice"}),e.jsxs("div",{className:"key-group",children:[e.jsx("label",{children:"Private Key (JWK):"}),e.jsx("textarea",{readOnly:!0,value:t}),e.jsx("button",{onClick:()=>s(t),children:"Copy"})]}),e.jsxs("div",{className:"key-group",children:[e.jsx("label",{children:"Public Key (JWK):"}),e.jsx("textarea",{readOnly:!0,value:c}),e.jsx("button",{onClick:()=>s(c),children:"Copy"})]}),e.jsxs("div",{className:"key-group",children:[e.jsx("label",{children:"Shared Secret:"}),e.jsx("textarea",{readOnly:!0,value:d}),e.jsx("button",{onClick:()=>s(d),children:"Copy"})]})]}),e.jsxs("div",{className:"party",children:[e.jsx("h3",{children:"Bob"}),e.jsxs("div",{className:"key-group",children:[e.jsx("label",{children:"Private Key (JWK):"}),e.jsx("textarea",{readOnly:!0,value:o}),e.jsx("button",{onClick:()=>s(o),children:"Copy"})]}),e.jsxs("div",{className:"key-group",children:[e.jsx("label",{children:"Public Key (JWK):"}),e.jsx("textarea",{readOnly:!0,value:n}),e.jsx("button",{onClick:()=>s(n),children:"Copy"})]}),e.jsxs("div",{className:"key-group",children:[e.jsx("label",{children:"Shared Secret:"}),e.jsx("textarea",{readOnly:!0,value:u}),e.jsx("button",{onClick:()=>s(u),children:"Copy"})]})]})]}),e.jsxs("div",{className:"info-box",children:[e.jsx("h3",{children:"How ECDH Works"}),e.jsxs("ol",{children:[e.jsx("li",{children:"Alice and Bob each generate their own public/private key pairs"}),e.jsx("li",{children:"They exchange public keys over an insecure channel"}),e.jsx("li",{children:"Each uses their private key and the other's public key to derive the same shared secret"}),e.jsx("li",{children:"The shared secret can be used to derive encryption keys"})]}),e.jsx("p",{className:"text-muted mt-2",children:"Note: This implementation uses ECDH with the P-256 elliptic curve (also known as secp256r1), which is widely supported and considered secure."})]})]})]})}export{J as default};
