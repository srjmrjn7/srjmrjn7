import{r as d,j as e}from"./index-CVcNbIs1.js";const I=async(s,t,n="")=>{var r;try{let a=s,i=t;t==="DKIM"?(i="TXT",a=`${n}._domainkey.${s}`):t==="SPF"&&(i="TXT");const o=await fetch(`https://cloudflare-dns.com/dns-query?name=${encodeURIComponent(a)}&type=${i}`,{headers:{Accept:"application/dns-json"}});if(!o.ok)throw new Error("Network response was not ok");const h=await o.json();return t==="SPF"?((r=h.Answer)==null?void 0:r.filter(u=>u.data.includes("v=spf1")))||[]:h.Answer||[]}catch(a){throw console.error("DNS query error:",a),a}},C=()=>{const[s,t]=d.useState([]),[n,r]=d.useState(null),[a,i]=d.useState(!1);return{results:s,error:n,isLoading:a,lookup:async(h,u,l="")=>{i(!0),r(null);try{const p=await I(h,u,l);t(p)}catch(p){r(p.message||"Failed to fetch DNS records"),t([])}finally{i(!1)}}}},A=async s=>{try{const t=await fetch(`https://api.whoisfreaks.com/v1.0/whois?whois=live&domainName=${s}&apiKey=7366ddf5195f47a6b36993f86a47c0f8`);if(!t.ok)throw new Error("WHOIS lookup failed");const n=await t.json();let r="";for(const[a,i]of Object.entries(n))i&&typeof i=="object"?r+=`${a}:
${JSON.stringify(i,null,2)}

`:r+=`${a}: ${i}
`;return r||"No WHOIS data available"}catch(t){throw console.error("WHOIS error:",t),new Error("Failed to fetch WHOIS data. Please try again later.")}},D=async(s=2048,t="default")=>{try{const n=await fetch(`https://api.maharjan-suraj.com.np/generate-dkim?key_size=${s}&selector=${encodeURIComponent(t)}`);if(!n.ok){const r=await n.json();throw new Error(r.error||"Failed to generate DKIM keys")}return await n.json()}catch(n){throw console.error("DKIM API error:",n),n}},T=async()=>{try{return(await fetch("https://api.maharjan-suraj.com.np/health")).ok}catch{return!1}},P=()=>{const[s,t]=d.useState({keys:null,isLoading:!1,error:null,keySize:2048,selector:"default",apiAvailable:!0});return{...s,generateKeys:async(a=2048,i="default")=>{t(o=>({...o,isLoading:!0,error:null,keys:null,keySize:a,selector:i}));try{const o=await D(a,i);if(o.success)t(h=>({...h,keys:o,isLoading:!1}));else throw new Error(o.error||"Generation failed")}catch(o){t(h=>({...h,error:o.message,isLoading:!1}))}},checkApiStatus:async()=>{const a=await T();return t(i=>({...i,apiAvailable:a})),a}}},K=[{value:2048,label:"2048-bit (Recommended)"},{value:3072,label:"3072-bit (High security)"},{value:4096,label:"4096-bit (Maximum security)"}],L=()=>{const{keys:s,isLoading:t,error:n,keySize:r,selector:a,apiAvailable:i,generateKeys:o,checkApiStatus:h}=P();d.useEffect(()=>{h()},[]);const u=l=>{navigator.clipboard.writeText(l)};return i?e.jsxs("div",{className:"dkim-generator",children:[e.jsxs("div",{className:"controls input-group",children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{htmlFor:"key-size",children:"Key Strength"}),e.jsx("select",{id:"key-size",value:r,onChange:l=>o(parseInt(l.target.value),a),disabled:t,children:K.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{htmlFor:"selector",children:"DKIM Selector"}),e.jsx("input",{id:"selector",type:"text",value:a,onChange:l=>o(r,l.target.value),disabled:t,placeholder:"default"})]}),e.jsx("button",{className:"generate-btn",onClick:()=>o(r,a),disabled:t,children:t?"Generating...":"Generate DKIM Keys"})]}),n&&e.jsx("div",{className:"error-message",children:n}),s&&e.jsxs("div",{className:"key-results",children:[e.jsxs("div",{className:"result-section",children:[e.jsxs("h3",{children:["DNS Record Information",e.jsx("button",{className:"copy-btn",onClick:()=>u(s.dkim_record),children:"Copy"})]}),e.jsx("div",{className:"key-display",children:e.jsx("table",{children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Record Name:"}),e.jsx("td",{children:e.jsxs("code",{children:[s.selector,"._domainkey.yourdomain.com"]})})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Record Type:"}),e.jsx("td",{children:"TXT"})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Record Value:"}),e.jsx("td",{children:e.jsx("pre",{children:s.dkim_record})})]})]})})}),e.jsxs("div",{className:"key-meta",children:[e.jsxs("span",{children:["Key Size: ",s.key_size,"-bit"]}),e.jsxs("span",{children:["Generated at: ",new Date(s.generated_at).toLocaleString()]})]})]}),e.jsxs("div",{className:"result-section",children:[e.jsxs("h3",{children:["Public Key",e.jsx("button",{className:"copy-btn",onClick:()=>u(s.public_key),children:"Copy"})]}),e.jsx("div",{className:"key-display",children:e.jsx("pre",{children:s.public_key})})]}),e.jsxs("div",{className:"result-section warning",children:[e.jsxs("h3",{children:["Private Key",e.jsx("button",{className:"copy-btn",onClick:()=>u(s.private_key),children:"Copy"})]}),e.jsx("div",{className:"key-display",children:e.jsx("pre",{children:s.private_key})}),e.jsx("p",{className:"security-warning",children:"⚠️ Store this securely! Never share or commit to version control."})]})]})]}):e.jsxs("div",{className:"api-error",children:[e.jsx("h2",{children:"DKIM Generator Service Unavailable"}),e.jsx("p",{children:"The DKIM generation service is currently unavailable. Please try again later."}),e.jsx("button",{onClick:h,children:"Retry Connection"})]})},_=s=>/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(s),g=async()=>{try{const s=await fetch("https://ipapi.co/json/");if(!s.ok)throw new Error("Failed to fetch IP information");const t=await s.json();if(!t.postal){const n=await fetch("https://ipwho.is/");if(n.ok){const r=await n.json();t.postal=r.postal||"Not available"}}return{ipv4:_(t.ip)?t.ip:await E(),ipv6:t.ip.includes(":")?t.ip:await M(),city:t.city||"Unknown",region:t.region||t.region_name||"Unknown",country_name:t.country_name||t.country||"Unknown",postal:t.postal||t.postal_code||"Not available",org:t.org||"Unknown",asn:t.asn||"Unknown",timezone:t.timezone||"Unknown",utc_offset:t.utc_offset||"Unknown",country:t.country_code||"Unknown",continent_code:t.continent_code||"Unknown",currency:t.currency||"Unknown"}}catch(s){throw console.error("IP info error:",s),new Error("Could not retrieve IP information")}},M=async()=>{try{const s=await fetch("https://api64.ipify.org?format=json");if(!s.ok)return"Not detected";const t=await s.json();return t.ip.includes(":")?t.ip:"Not detected"}catch{return"Not detected"}},E=async()=>{const s=n=>/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(n),t=[{url:"https://api.ipify.org?format=json",parser:n=>n.json().then(r=>r.ip)},{url:"https://ipv4.icanhazip.com",parser:n=>n.text().then(r=>r.trim())},{url:"https://checkip.amazonaws.com",parser:n=>n.text().then(r=>r.trim())},{url:"https://api.myip.com",parser:n=>n.json().then(r=>r.ip)}];for(const n of t)try{const r=await fetch(n.url,{signal:AbortSignal.timeout(3e3)});if(!r.ok)continue;const a=await n.parser(r);if(a&&s(a))return a}catch(r){console.warn(`Failed with ${n.url}:`,r.message);continue}throw new Error("All IPv4 services failed")},R=()=>{const[s,t]=d.useState(null),[n,r]=d.useState(!0),[a,i]=d.useState(null);d.useEffect(()=>{(async()=>{try{r(!0);const l=await g();t(l),i(null)}catch(l){i(l.message)}finally{r(!1)}})()},[]);const o=async()=>{try{r(!0);const u=await g();t(u),i(null)}catch(u){i(u.message)}finally{r(!1)}},h=u=>{navigator.clipboard.writeText(u)};return n?e.jsxs("div",{className:"ip-info-loading",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Detecting your network information..."})]}):a?e.jsxs("div",{className:"ip-info-error",children:[e.jsx("p",{children:a}),e.jsx("button",{onClick:o,children:"Retry"})]}):e.jsxs("div",{className:"ip-info",children:[e.jsxs("div",{className:"ip-info-header",children:[e.jsx("h2",{children:"Your Network Information"}),e.jsx("button",{onClick:o,className:"refresh-btn",children:"Refresh"})]}),e.jsxs("div",{className:"ip-info-grid",children:[e.jsxs("div",{className:"ip-info-card",children:[e.jsx("h3",{children:"IPv4 Address"}),e.jsxs("div",{className:"ip-value",children:[e.jsx("code",{children:s.ipv4}),e.jsx("button",{onClick:()=>h(s.ipv4),children:"Copy"})]})]}),e.jsxs("div",{className:"ip-info-card",children:[e.jsx("h3",{children:"IPv6 Address"}),e.jsxs("div",{className:"ip-value",children:[e.jsx("code",{children:s.ipv6}),s.ipv6!=="Not detected"&&e.jsx("button",{onClick:()=>h(s.ipv6),children:"Copy"})]})]}),e.jsxs("div",{className:"ip-info-card",children:[e.jsx("h3",{children:"Location"}),e.jsxs("p",{children:[s.city,", ",s.region,", ",s.country_name]}),s.postal!=="Not available"&&e.jsxs("p",{children:["Postal Code: ",s.postal]})]}),e.jsxs("div",{className:"ip-info-card",children:[e.jsx("h3",{children:"Network"}),e.jsxs("p",{children:["ISP: ",s.org]}),e.jsxs("p",{children:["ASN: ",s.asn]})]}),e.jsxs("div",{className:"ip-info-card",children:[e.jsx("h3",{children:"Timezone"}),e.jsx("p",{children:s.timezone}),e.jsxs("p",{children:["UTC Offset: ",s.utc_offset]})]}),e.jsxs("div",{className:"ip-info-card",children:[e.jsx("h3",{children:"Other Details"}),e.jsxs("p",{children:["Country Code: ",s.country]}),e.jsxs("p",{children:["Continent Code: ",s.continent_code]}),e.jsxs("p",{children:["Currency: ",s.currency]})]})]})]})},F=[{value:"A",label:"A (IPv4 Address)"},{value:"AAAA",label:"AAAA (IPv6 Address)"},{value:"CNAME",label:"CNAME (Canonical Name)"},{value:"MX",label:"MX (Mail Exchange)"},{value:"NS",label:"NS (Name Server)"},{value:"TXT",label:"TXT (Text Record)"},{value:"SOA",label:"SOA (Start of Authority)"},{value:"SPF",label:"SPF (Sender Policy Framework)"},{value:"DKIM",label:"DKIM (DomainKeys Identified Mail)"}],O=()=>{const[s,t]=d.useState("dns"),[n,r]=d.useState(""),[a,i]=d.useState("A"),[o,h]=d.useState("default"),{results:u,error:l,isLoading:p,lookup:j}=C(),[$,z]=d.useState("2048"),[f,v]=d.useState(null),[m,y]=d.useState(!1),[k,x]=d.useState(null),N=()=>{s==="dkim"?j(n,"DKIM",o):s==="spf"?j(n,"SPF"):j(n,a)},w=()=>p?e.jsx("div",{className:"loading",children:"Loading..."}):l?e.jsx("div",{className:"error",children:l}):u.map((c,S)=>e.jsxs("div",{className:"record",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",c.type]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",c.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"TTL:"})," ",c.TTL]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Data:"})," ",c.data]})]},S)),b=async()=>{if(!n){x("Please enter a domain");return}y(!0),x(null),v(null);try{const c=await A(n);v(c)}catch(c){x(c.message)}finally{y(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"dns-tool container",children:[e.jsx("h1",{className:"content-title",children:"DNS Tool"}),e.jsxs("div",{className:"tabs",children:[e.jsx("button",{className:s==="dns"?"active":"",onClick:()=>t("dns"),children:"DNS Lookup"}),e.jsx("button",{className:s==="whois"?"active":"",onClick:()=>t("whois"),children:"Whois Lookup"}),e.jsx("button",{className:s==="ipinfo"?"active":"",onClick:()=>t("ipinfo"),children:"What's My IP"}),e.jsx("button",{className:s==="dkim"?"active":"",onClick:()=>t("dkim"),children:"DKIM Check"}),e.jsx("button",{className:s==="spf"?"active":"",onClick:()=>t("spf"),children:"SPF Check"}),e.jsx("button",{className:s==="generate"?"active":"",onClick:()=>t("generate"),children:"DKIM Generator"})]}),e.jsxs("div",{className:"tool-content",children:[s==="whois"&&e.jsxs("div",{className:"tool-section",children:[e.jsxs("div",{className:"form input-group",children:[e.jsx("input",{type:"text",value:n,onChange:c=>r(c.target.value),placeholder:"example.com",className:"input"}),e.jsx("button",{onClick:b,disabled:m,className:`button ${m?"button-disabled":""}`,children:m?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner"}),"Checking..."]}):"Lookup WHOIS"})]}),k&&e.jsx("p",{className:"error",children:k}),f&&e.jsxs("div",{className:"whois-results",children:[e.jsxs("h3",{children:["WHOIS Results for ",n]}),e.jsx("pre",{children:f})]})]}),s=="generate"&&e.jsx("div",{className:"generator",children:e.jsx(L,{})}),s==="ipinfo"&&e.jsx(R,{}),s!=="generate"&&s!=="whois"&&s!=="ipinfo"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",value:n,onChange:c=>r(c.target.value),placeholder:"example.com"}),s==="dns"&&e.jsx("select",{value:a,onChange:c=>i(c.target.value),children:F.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))}),s==="dkim"&&e.jsx("input",{type:"text",value:o,onChange:c=>h(c.target.value),placeholder:"Selector (default)"}),e.jsx("button",{onClick:N,disabled:!n||p,children:p?"Checking...":"Lookup"})]}),e.jsx("div",{className:"results",children:w()})]})]})]})})};export{O as default};
