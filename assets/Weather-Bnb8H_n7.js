import{r as n,j as e}from"./index-CVcNbIs1.js";import{a as p}from"./index-ngrFHoWO.js";const T=()=>{const[r,j]=n.useState(null),[N,o]=n.useState(!0),[f,i]=n.useState(null),[h,y]=n.useState(""),[m,b]=n.useState("hourly"),[s,S]=n.useState("metric"),[l,k]=n.useState(null);n.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{k({lat:t.coords.latitude,lon:t.coords.longitude}),x(t.coords.latitude,t.coords.longitude)},t=>{console.error("Error getting location:",t),i("Could not get your location. Showing default weather for London."),u("London")}):(i("Geolocation is not supported by your browser. Showing default weather for London."),u("London"))},[]);const x=async(t,a)=>{try{o(!0),i(null);const[c,w]=await Promise.all([p.get(`https://api.openweathermap.org/data/2.5/weather?lat=${t}&lon=${a}&appid=68b575b452a5a66bd05cd6c635eafcda&units=${s}`),p.get(`https://api.openweathermap.org/data/2.5/forecast?lat=${t}&lon=${a}&appid=68b575b452a5a66bd05cd6c635eafcda&units=${s}`)]);j({current:c.data,forecast:w.data}),o(!1)}catch{i("Failed to fetch weather data. Please try again."),o(!1)}},u=async t=>{try{o(!0),i(null);const[a,c]=await Promise.all([p.get(`https://api.openweathermap.org/data/2.5/weather?q=${t}&appid=68b575b452a5a66bd05cd6c635eafcda&units=${s}`),p.get(`https://api.openweathermap.org/data/2.5/forecast?q=${t}&appid=68b575b452a5a66bd05cd6c635eafcda&units=${s}`)]);j({current:a.data,forecast:c.data}),o(!1)}catch{i("Failed to fetch weather data. Please check the city name and try again."),o(!1)}},v=t=>{t.preventDefault(),h.trim()&&u(h.trim())},$=()=>{S(s==="metric"?"imperial":"metric"),l?x(l.lat,l.lon):r&&u(r.current.name)},g=t=>`https://openweathermap.org/img/wn/${t}@2x.png`,D=t=>new Date(t*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),C=t=>new Date(t*1e3).toLocaleDateString([],{weekday:"long"});if(N&&!r)return e.jsxs("div",{className:"container weather-container loading",children:[e.jsx("p",{children:"Detecting your location and loading weather data..."}),e.jsx("div",{className:"spinner"})]});if(f&&!r)return e.jsxs("div",{className:"weather-container error",children:[e.jsx("p",{children:f}),e.jsxs("form",{onSubmit:v,children:[e.jsx("input",{type:"text",value:h,onChange:t=>y(t.target.value),placeholder:"Enter city name"}),e.jsx("button",{type:"submit",children:"Search"})]})]});if(!r)return null;const d={};r.forecast.list.forEach(t=>{const a=new Date(t.dt*1e3).toLocaleDateString();d[a]||(d[a]=[]),d[a].push(t)});const L=Object.keys(d).map(t=>{const a=d[t],c=a.map(w=>w.main.temp);return{date:a[0].dt,minTemp:Math.min(...c),maxTemp:Math.max(...c),icon:a[Math.floor(a.length/2)].weather[0].icon,description:a[Math.floor(a.length/2)].weather[0].main}});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"weather-container container",children:[e.jsx("h1",{className:"content-title",children:"Weather"}),e.jsxs("div",{className:"weather-header",children:[e.jsxs("h3",{children:[r.current.name,", ",r.current.sys.country,e.jsxs("span",{className:"current-temp",children:[Math.round(r.current.main.temp),"°",s==="metric"?"C":"F"]})]}),e.jsxs("div",{className:"current-weather",children:[e.jsx("img",{src:g(r.current.weather[0].icon),alt:r.current.weather[0].description}),e.jsx("p",{children:r.current.weather[0].main}),e.jsxs("p",{children:["Humidity: ",r.current.main.humidity,"%"]}),e.jsxs("p",{children:["Wind: ",Math.round(r.current.wind.speed)," ",s==="metric"?"m/s":"mph"]})]}),e.jsxs("form",{onSubmit:v,className:"search-form",children:[e.jsx("input",{type:"text",value:h,onChange:t=>y(t.target.value),placeholder:"Search another location"}),e.jsxs("div",{className:"button-group",children:[e.jsx("button",{type:"submit",children:"Search"}),e.jsx("button",{type:"button",onClick:()=>l&&x(l.lat,l.lon),className:"location-button",title:"Refresh with current location",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16",children:e.jsx("path",{d:"M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"})})}),e.jsxs("button",{type:"button",onClick:$,className:"unit-toggle",children:["°",s==="metric"?"F":"C"]})]})]})]}),e.jsxs("div",{className:"forecast-tabs",children:[e.jsx("button",{className:m==="hourly"?"active":"",onClick:()=>b("hourly"),children:"Hourly Forecast"}),e.jsx("button",{className:m==="weekly"?"active":"",onClick:()=>b("weekly"),children:"Weekly Forecast"})]}),m==="hourly"&&e.jsxs("div",{className:"hourly-forecast",children:[e.jsx("h3",{children:"Next 24 Hours"}),e.jsx("div",{className:"hourly-items",children:r.forecast.list.slice(0,8).map((t,a)=>e.jsxs("div",{className:"hourly-item",children:[e.jsx("strong",{children:D(t.dt)}),e.jsx("img",{src:g(t.weather[0].icon),alt:t.weather[0].description}),e.jsxs("span",{children:[Math.round(t.main.temp),"°"]}),e.jsx("p",{className:"small",children:t.weather[0].main})]},a))})]}),m==="weekly"&&e.jsxs("div",{className:"weekly-forecast",children:[e.jsx("h3",{children:"7-Day Forecast"}),e.jsx("div",{className:"weekly-items",children:L.slice(0,7).map((t,a)=>e.jsxs("div",{className:"weekly-item",children:[e.jsx("strong",{children:C(t.date)}),e.jsx("img",{src:g(t.icon),alt:t.description}),e.jsxs("div",{className:"temp-range",children:[e.jsxs("span",{className:"max-temp",children:[Math.round(t.maxTemp),"°"]}),e.jsxs("span",{className:"min-temp",children:[Math.round(t.minTemp),"°"]})]}),e.jsx("p",{className:"small",children:t.description})]},a))})]})]})})};export{T as default};
