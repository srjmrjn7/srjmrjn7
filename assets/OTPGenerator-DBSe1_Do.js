import{r as s,j as e,H as N}from"./index-CVcNbIs1.js";import{Q as R}from"./index-LBQ1Upra.js";import{u as G}from"./globalStore-ByoUXurI.js";import"./index-Chjiymov.js";async function U(r,u="SHA-1",c=6,m=30){const j=new TextEncoder().encode(r),l=Math.floor(Date.now()/1e3/m),g=new ArrayBuffer(8),a=new DataView(g);for(let d=0;d<8;d++)a.setUint8(7-d,l>>>d*8&255);const f=await window.crypto.subtle.importKey("raw",j,{name:"HMAC",hash:{name:u}},!1,["sign"]),i=await window.crypto.subtle.sign("HMAC",f,a.buffer),n=new Uint8Array(i),o=n[n.length-1]&15;return(((n[o]&127)<<24|n[o+1]<<16|n[o+2]<<8|n[o+3])%Math.pow(10,c)).toString().padStart(c,"0")}function D(){const[r,u]=s.useState(""),[c,m]=s.useState(""),[y,j]=s.useState(30),[l,g]=s.useState("SHA-1"),[a,f]=s.useState(6),[i,n]=s.useState(30),[o,S]=s.useState("MyApp"),[h,d]=s.useState("MyCompany"),[p,O]=s.useState(""),[b,C]=s.useState(!1),{theme:P}=G(),H="Q",A=async()=>{C(!0);try{const t=await A();u(t)}catch(t){console.error("Error generating secret:",t),alert("Failed to generate secret. See console for details.")}finally{C(!1)}},w=async()=>{if(r)try{const t=await U(r,l,a,i);m(t),T()}catch(t){console.error("Error generating OTP:",t),alert("Failed to generate OTP. See console for details.")}},T=()=>{if(!r)return;const t=encodeURIComponent(o),x=encodeURIComponent(h),I=l.replace("-",""),k=`otpauth://totp/${t}?secret=${r}&issuer=${x}&algorithm=${I}&digits=${a}&period=${i}`;O(k)},v=t=>{navigator.clipboard.writeText(t)};return s.useEffect(()=>{w();const t=setInterval(()=>{j(x=>x<=1?(w(),i):x-1)},1e3);return()=>clearInterval(t)},[r,l,a,i]),s.useEffect(()=>{T()},[o,h]),e.jsxs(e.Fragment,{children:[e.jsx(N,{children:e.jsx("title",{children:"One-Time Password (OTP) Generator - Suraj Site"})}),e.jsxs("div",{className:"otp-generator",children:[e.jsx("h2",{children:"One-Time Password (OTP) Generator"}),e.jsxs("div",{className:"controls",children:[e.jsxs("div",{className:"control-group",children:[e.jsxs("label",{children:["Algorithm:",e.jsxs("select",{value:l,onChange:t=>g(t.target.value),children:[e.jsx("option",{value:"SHA-1",children:"SHA-1"}),e.jsx("option",{value:"SHA-256",children:"SHA-256"}),e.jsx("option",{value:"SHA-512",children:"SHA-512"})]})]}),e.jsxs("label",{children:["Digits:",e.jsxs("select",{value:a,onChange:t=>f(parseInt(t.target.value)),children:[e.jsx("option",{value:"6",children:"6"}),e.jsx("option",{value:"8",children:"8"})]})]}),e.jsxs("label",{children:["Period (seconds):",e.jsx("input",{type:"number",value:i,onChange:t=>n(parseInt(t.target.value)||30),min:"10",max:"90",step:"10"})]})]}),e.jsxs("div",{className:"control-group",children:[e.jsxs("label",{children:["Label:",e.jsx("input",{type:"text",value:o,onChange:t=>S(t.target.value),placeholder:"App/Service name"})]}),e.jsxs("label",{children:["Issuer:",e.jsx("input",{type:"text",value:h,onChange:t=>d(t.target.value),placeholder:"Company name"})]})]})]}),e.jsxs("div",{className:"secret-section",children:[e.jsx("h3",{children:"Secret Key"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",value:r,onChange:t=>u(t.target.value),placeholder:"Enter secret key"}),e.jsx("button",{onClick:A,disabled:b,children:b?"Generating...":"Generate Random Key"}),r&&e.jsx("button",{onClick:()=>v(r),children:"Copy"})]})]}),e.jsxs("div",{className:"otp-display",children:[e.jsx("h3",{children:"Current OTP"}),e.jsxs("div",{className:"otp-token",children:[e.jsx("span",{children:c||"Generate a secret first"}),e.jsxs("span",{className:"timer",children:["Refreshes in: ",y,"s"]})]}),c&&e.jsx("button",{onClick:()=>v(c),children:"Copy OTP"})]}),p&&e.jsxs("div",{className:"uri-section",children:[e.jsx("h3",{children:"OTP Auth URI"}),e.jsx("textarea",{value:p,readOnly:!0,onClick:t=>t.target.select()}),e.jsx("button",{onClick:()=>v(p),children:"Copy URI"}),e.jsxs("div",{className:"qr-code",children:[e.jsx("h4",{children:"QR Code (Scan with Authenticator Apps)"}),e.jsx(R,{value:encodeURIComponent(p),size:256,bgColor:P==="dark"?"#121212":"#ffffff",fgColor:"#000000",level:H})]})]}),e.jsxs("div",{className:"info-box",children:[e.jsx("h3",{children:"About OTP"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"TOTP"})," (Time-based One-Time Password) is commonly used for 2FA"]}),e.jsx("li",{children:"Compatible with Google Authenticator, Authy, Microsoft Authenticator, etc."}),e.jsx("li",{children:"Secrets should be kept secure and never shared"}),e.jsx("li",{children:"Standard settings are SHA-1 algorithm, 6 digits, 30-second period"})]})]})]})]})}export{D as default};
