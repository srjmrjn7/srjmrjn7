import{r,j as s}from"./index-CVcNbIs1.js";import{C as G}from"./ChatbotResponse-Bf3dVQ4q.js";import{C as R}from"./check-IByWjbWO.js";import{C as Y}from"./copy-YkZRD4rb.js";import"./index-D3SECd0l.js";import"./index-BTARlc8I.js";import"./createLucideIcon-Ctnp8qhN.js";const q=()=>{const[o,A]=r.useState("openai"),[c,j]=r.useState(""),[P,x]=r.useState([]),[m,f]=r.useState(!1),[d,v]=r.useState({openai:"",gemini:"",anthropic:"",mistral:""}),[p,S]=r.useState({openai:"You are a helpful AI assistant. Provide accurate and concise responses.",gemini:"You are a helpful AI assistant. Respond clearly and format answers properly.",anthropic:"You are a helpful, harmless, and honest AI assistant.",mistral:"You are a helpful AI assistant. Be concise and accurate in your responses."}),[O,g]=r.useState(!1),[h,y]=r.useState(""),[E,b]=r.useState(null),a={openai:{name:"OpenAI",models:["gpt-4o","gpt-4-turbo","gpt-3.5-turbo"],needsKey:!0,endpoint:"https://api.openai.com/v1/chat/completions"},gemini:{name:"Gemini",models:["gemini-2.5-flash","gemini-2.5-pro"],needsKey:!0,endpoint:"https://generativelanguage.googleapis.com/v1beta/models"},anthropic:{name:"Claude",models:["claude-3-opus-20240229","claude-3-sonnet-20240229"],needsKey:!0,endpoint:"https://api.anthropic.com/v1/messages"},mistral:{name:"Mistral",models:["mistral-tiny","mistral-small","mistral-medium"],needsKey:!0,endpoint:"https://api.mistral.ai/v1/chat/completions"}},u=a[o].needsKey&&!d[o],T=(e,t)=>{navigator.clipboard.writeText(e),b(t),setTimeout(()=>b(null),2e3)},w=async()=>{if(!c.trim()||m||u)return;const e={id:Date.now(),sender:"user",content:c,timestamp:new Date,provider:o};x(t=>[...t,e]),j(""),f(!0);try{let t;switch(o){case"openai":t=await M(c);break;case"gemini":t=await K(c);break;case"anthropic":t=await $(c);break;case"mistral":t=await _(c);break;default:throw new Error("Unsupported provider")}const i={id:Date.now()+1,sender:"ai",content:t,timestamp:new Date,provider:o};x(n=>[...n,i])}catch(t){console.error("Error:",t)}finally{f(!1)}},M=async e=>{var n;const t=await fetch(a.openai.endpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d.openai}`},body:JSON.stringify({model:h,messages:[{role:"system",content:p.openai},{role:"user",content:e}],temperature:.7})});if(!t.ok){const l=await t.json();throw new Error(((n=l.error)==null?void 0:n.message)||"OpenAI API error")}return(await t.json()).choices[0].message.content},K=async e=>{var n,l,N,C,I,k;const t=await fetch(`${a.gemini.endpoint}/${h}:generateContent?key=${d.gemini}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}],systemInstruction:{parts:[{text:p.gemini}]},generationConfig:{temperature:.7,maxOutputTokens:8192}})});if(!t.ok){const J=await t.json();throw new Error(((n=J.error)==null?void 0:n.message)||"Gemini API error")}const i=await t.json();if((k=(I=(C=(N=(l=i.candidates)==null?void 0:l[0])==null?void 0:N.content)==null?void 0:C.parts)==null?void 0:I[0])!=null&&k.text)return i.candidates[0].content.parts[0].text;throw new Error("Invalid response from Gemini API")},$=async e=>{var n;const t=await fetch(a.anthropic.endpoint,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":d.anthropic,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:h,messages:[{role:"user",content:e}],system:p.anthropic,max_tokens:2e3})});if(!t.ok){const l=await t.json();throw new Error(((n=l.error)==null?void 0:n.message)||"Anthropic API error")}return(await t.json()).content[0].text},_=async e=>{var n;const t=await fetch(a.mistral.endpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d.mistral}`},body:JSON.stringify({model:h,messages:[{role:"system",content:p.mistral},{role:"user",content:e}],temperature:.7})});if(!t.ok){const l=await t.json();throw new Error(((n=l.error)==null?void 0:n.message)||"Mistral API error")}return(await t.json()).choices[0].message.content},D=()=>{localStorage.setItem("ai_api_keys",JSON.stringify(d)),localStorage.setItem("ai_system_prompts",JSON.stringify(p)),g(!1)};return r.useEffect(()=>{const e=localStorage.getItem("ai_api_keys"),t=localStorage.getItem("ai_system_prompts");e&&v(JSON.parse(e)),t&&S(JSON.parse(t)),y(a[o].models[0])},[]),r.useEffect(()=>{y(a[o].models[0])},[o]),s.jsxs("div",{className:"ai-chat-container container",children:[s.jsx("h1",{className:"content-title",children:"AI Chat"}),s.jsx("div",{className:"bot-selector",children:Object.keys(a).map(e=>s.jsx("button",{className:`bot-btn btn ${o===e?"active":""}`,onClick:()=>A(e),children:s.jsx("span",{className:"bot-name",children:a[e].name})},e))}),s.jsxs("div",{className:"chat-controls",children:[s.jsx("select",{value:h,onChange:e=>y(e.target.value),disabled:m,className:"model-selector",children:a[o].models.map(e=>s.jsx("option",{value:e,children:e},e))}),s.jsx("button",{className:"settings-btn",onClick:()=>g(!0),children:"Settings"})]}),s.jsxs("div",{className:"chat-messages",children:[P.map(e=>s.jsxs("div",{className:`message ${e.sender} ${e.provider}`,children:[s.jsxs("div",{className:"message-header",children:[s.jsx("div",{className:"message-sender",children:e.sender==="user"?"You":s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"bot-icon",children:a[e.provider].icon}),a[e.provider].name]})}),s.jsxs("div",{className:"message-meta",children:[s.jsx("span",{className:"timestamp",children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),s.jsx("button",{className:"copy-btn",onClick:()=>T(e.content,e.id),title:"Copy to clipboard",children:E===e.id?s.jsx(R,{size:"14"}):s.jsx(Y,{size:"14"})})]})]}),s.jsx("div",{className:"message-content",children:s.jsx(G,{text:e.content})})]},e.id)),m&&s.jsx("div",{className:`message ai ${o}`,children:s.jsxs("div",{className:"typing-indicator",children:[s.jsx("span",{children:"•"}),s.jsx("span",{children:"•"}),s.jsx("span",{children:"•"})]})})]}),s.jsxs("div",{className:"input-area",children:[s.jsx("input",{type:"text",value:c,onChange:e=>j(e.target.value),placeholder:u?`Add ${a[o].name} API key in Settings`:"Type your message...",disabled:m||u,onKeyPress:e=>e.key==="Enter"&&w(),className:"message-input"}),s.jsx("button",{onClick:w,disabled:!c.trim()||m||u,className:"send-btn",children:m?"Generating...":"Send"})]}),O&&s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"settings-modal",children:[s.jsx("h3",{children:"Chat Settings"}),s.jsxs("div",{className:"settings-section",children:[s.jsx("h4",{children:"System Prompts"}),Object.keys(a).map(e=>s.jsxs("div",{className:"prompt-input",children:[s.jsx("label",{children:a[e].name}),s.jsx("textarea",{value:p[e],onChange:t=>S(i=>({...i,[e]:t.target.value})),placeholder:`System prompt for ${a[e].name}`,rows:3})]},e))]}),s.jsxs("div",{className:"settings-section",children:[s.jsx("h4",{children:"API Keys"}),Object.keys(a).map(e=>a[e].needsKey&&s.jsxs("div",{className:"api-key-input",children:[s.jsx("label",{children:a[e].name}),s.jsx("input",{type:"password",value:d[e],onChange:t=>v(i=>({...i,[e]:t.target.value})),placeholder:`Enter ${a[e].name} API key`})]},e))]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{onClick:D,className:"save-btn",children:"Save Settings"}),s.jsx("button",{onClick:()=>g(!1),className:"cancel-btn",children:"Cancel"})]})]})})]})};export{q as default};
